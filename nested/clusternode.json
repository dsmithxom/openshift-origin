{
	"$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json",
	"contentVersion": "1.0.0.0",
	"parameters": {
		"location": {
			"type": "string",
			"minLength": 1,
			"metadata": {
				"description": "Datacenter Region Location"
			}
		},
		"sshKeyPath": {
			"type": "string",
			"minLength": 1,
			"metadata": {
				"description": "SSH Public Key Path"
			}
		},
		"sshPublicKey": {
			"type": "string",
			"minLength": 1,
			"metadata": {
				"description": "SSH Public Key"
			}
		},
		"dataDiskSize": {
			"type": "int",
			"metadata": {
				"description": "Size of Data Disk"
			}
		},
		"adminUsername": {
			"type": "string",
			"minLength": 1,
			"metadata": {
				"description": "Admin Username"
			}
		},
		"vmSize": {
			"type": "string",
			"minLength": 1,
			"metadata": {
				"description": "VM Size"
			}
		},
		"availabilitySet": {
			"type": "string",
			"minLength": 1,
			"metadata": {
				"description": "Name of Availibility Set"
			}
		},
		"osImage": {
			"type": "string",
			"metadata": {
				"description": "Image Reference - CentOS or RHEL"
			}
		},
		"hostname": {
			"type": "string",
			"minLength": 1,
			"metadata": {
				"description": "VM Hostname"
			}
		},
		"storageAccountTypeData": {
			"type": "string",
			"minLength": 1,
			"metadata": {
				"description": "Storage Account for Data Disk"
			}
		},

		"apiVersionCompute": {
			"type": "string",
			"minLength": 1,
			"metadata": {
				"description": "Compute API Version"
			}
		}
	},
	"variables": {
		"centos": { 
			"publisher": "Openlogic", 
			"offer": "CentOS", 
			"sku": "7.3", 
			"version": "latest" 
		}, 
		"rhel": {
			"publisher": "RedHat",
			"offer": "RHEL",
			"sku": "7-RAW",
			"version": "latest"
		},
		"vmSizesMap": {
			"Standard_A4": {
				"storageAccountType": "Standard_LRS"
			},
			"Standard_A5": {
				"storageAccountType": "Standard_LRS"
			},
			"Standard_A6": {
				"storageAccountType": "Standard_LRS"
			},
			"Standard_A7": {
				"storageAccountType": "Standard_LRS"
			},
			"Standard_A8": {
				"storageAccountType": "Standard_LRS"
			},
			"Standard_A9": {
				"storageAccountType": "Standard_LRS"
			},
			"Standard_A10": {
				"storageAccountType": "Standard_LRS"
			},
			"Standard_A11": {
				"storageAccountType": "Standard_LRS"
			},
			"Standard_D1": {
				"storageAccountType": "Standard_LRS"
			},
			"Standard_D2": {
				"storageAccountType": "Standard_LRS"
			},
			"Standard_D3": {
				"storageAccountType": "Standard_LRS"
			},
			"Standard_D4": {
				"storageAccountType": "Standard_LRS"
			},
			"Standard_D11": {
				"storageAccountType": "Standard_LRS"
			},
			"Standard_D12": {
				"storageAccountType": "Standard_LRS"
			},
			"Standard_D13": {
				"storageAccountType": "Standard_LRS"
			},
			"Standard_D14": {
				"storageAccountType": "Standard_LRS"
			},
			"Standard_D1_v2": {
				"storageAccountType": "Standard_LRS"
			},
			"Standard_D2_v2": {
				"storageAccountType": "Standard_LRS"
			},
			"Standard_D3_v2": {
				"storageAccountType": "Standard_LRS"
			},
			"Standard_D4_v2": {
				"storageAccountType": "Standard_LRS"
			},
			"Standard_D5_v2": {
				"storageAccountType": "Standard_LRS"
			},
			"Standard_D11_v2": {
				"storageAccountType": "Standard_LRS"
			},
			"Standard_D12_v2": {
				"storageAccountType": "Standard_LRS"
			},
			"Standard_D13_v2": {
				"storageAccountType": "Standard_LRS"
			},
			"Standard_D14_v2": {
				"storageAccountType": "Standard_LRS"
			},
			"Standard_G1": {
				"storageAccountType": "Standard_LRS"
			},
			"Standard_G2": {
				"storageAccountType": "Standard_LRS"
			},
			"Standard_G3": {
				"storageAccountType": "Standard_LRS"
			},
			"Standard_G4": {
				"storageAccountType": "Standard_LRS"
			},
			"Standard_G5": {
				"storageAccountType": "Standard_LRS"
			},
			"Standard_DS1": {
				"storageAccountType": "Premium_LRS"
			},
			"Standard_DS2": {
				"storageAccountType": "Premium_LRS"
			},
			"Standard_DS3": {
				"storageAccountType": "Premium_LRS"
			},
			"Standard_DS4": {
				"storageAccountType": "Premium_LRS"
			},
			"Standard_DS11": {
				"storageAccountType": "Premium_LRS"
			},
			"Standard_DS12": {
				"storageAccountType": "Premium_LRS"
			},
			"Standard_DS13": {
				"storageAccountType": "Premium_LRS"
			},
			"Standard_DS14": {
				"storageAccountType": "Premium_LRS"
			},
			"Standard_DS1_v2": {
				"storageAccountType": "Premium_LRS"
			},
			"Standard_DS2_v2": {
				"storageAccountType": "Premium_LRS"
			},
			"Standard_DS3_v2": {
				"storageAccountType": "Premium_LRS"
			},
			"Standard_DS4_v2": {
				"storageAccountType": "Premium_LRS"
			},
			"Standard_DS5_v2": {
				"storageAccountType": "Premium_LRS"
			},
			"Standard_DS11_v2": {
				"storageAccountType": "Premium_LRS"
			},
			"Standard_DS12_v2": {
				"storageAccountType": "Premium_LRS"
			},
			"Standard_DS13_v2": {
				"storageAccountType": "Premium_LRS"
			},
			"Standard_DS14_v2": {
				"storageAccountType": "Premium_LRS"
			},
			"Standard_DS15_v2": {
				"storageAccountType": "Premium_LRS"
			},
			"Standard_GS1": {
				"storageAccountType": "Premium_LRS"
			},
			"Standard_GS2": {
				"storageAccountType": "Premium_LRS"
			},
			"Standard_GS3": {
				"storageAccountType": "Premium_LRS"
			},
			"Standard_GS4": {
				"storageAccountType": "Premium_LRS"
			},
			"Standard_GS5": {
				"storageAccountType": "Premium_LRS"
			},
			"Standard_D2_v3": {
				"storageAccountType": "Standard_LRS"
			},
			"Standard_D4_v3": {
				"storageAccountType": "Standard_LRS"
			},
			"Standard_D8_v3": {
				"storageAccountType": "Standard_LRS"
			},
			"Standard_D16_v3": {
				"storageAccountType": "Standard_LRS"
			},
			"Standard_D32_v3": {
				"storageAccountType": "Standard_LRS"
			},
			"Standard_D64_v3": {
				"storageAccountType": "Standard_LRS"
			},
			"Standard_D2s_v3": {
				"storageAccountType": "Premium_LRS"
			},
			"Standard_D4s_v3": {
				"storageAccountType": "Premium_LRS"
			},
			"Standard_D8s_v3": {
				"storageAccountType": "Premium_LRS"
			},
			"Standard_D16s_v3": {
				"storageAccountType": "Premium_LRS"
			},
			"Standard_D32s_v3": {
				"storageAccountType": "Premium_LRS"
			},
			"Standard_D64s_v3": {
				"storageAccountType": "Premium_LRS"
			},
			"Standard_E2_v3": {
				"storageAccountType": "Standard_LRS"
			},
			"Standard_E4_v3": {
				"storageAccountType": "Standard_LRS"
			},
			"Standard_E8_v3": {
				"storageAccountType": "Standard_LRS"
			},
			"Standard_E16_v3": {
				"storageAccountType": "Standard_LRS"
			},
			"Standard_E32_v3": {
				"storageAccountType": "Standard_LRS"
			},
			"Standard_E64_v3": {
				"storageAccountType": "Standard_LRS"
			},
			"Standard_E2s_v3": {
				"storageAccountType": "Premium_LRS"
			},
			"Standard_E4s_v3": {
				"storageAccountType": "Premium_LRS"
			},
			"Standard_E8s_v3": {
				"storageAccountType": "Premium_LRS"
			},
			"Standard_E16s_v3": {
				"storageAccountType": "Premium_LRS"
			},
			"Standard_E32s_v3": {
				"storageAccountType": "Premium_LRS"
			},
			"Standard_E64s_v3": {
				"storageAccountType": "Premium_LRS"
			}
		}
	},
	"resources": [{
		"type": "Microsoft.Compute/virtualMachines",
		"name": "[parameters('hostname')]",
		"location": "[parameters('location')]",
		"apiVersion": "[parameters('apiVersionCompute')]",
		"tags": {
			"displayName": "[concat(parameters('hostname'), ' VM Creation')]"
		},
		"properties": {
			"availabilitySet": {
				"id": "[resourceId('Microsoft.Compute/availabilitySets', parameters('availabilitySet'))]"
			},
			"hardwareProfile": {
				"vmSize": "[parameters('vmSize')]"
			},
			"osProfile": {
				"computerName": "[parameters('hostname')]",
				"adminUsername": "[parameters('adminUsername')]",
				"linuxConfiguration": {
					"disablePasswordAuthentication": true,
					"ssh": {
						"publicKeys": [{
							"path": "[parameters('sshKeyPath')]",
							"keyData": "[parameters('sshPublicKey')]"
						}]
					}
				}
			},
			"storageProfile": {
				"imageReference": "[variables(parameters('osImage'))]",
				"osDisk": {
					"name": "[concat(parameters('hostname'), 'osdisk')]",
					"caching": "ReadWrite",
					"createOption": "FromImage",
					"managedDisk":{
						"storageAccountType": "[variables('vmSizesMap')[parameters('vmSize')].storageAccountType]"
					  }
				},
				"dataDisks": [{
					"name": "[concat(parameters('hostname'), '-docker-pool')]",
					"diskSizeGB": "[parameters('dataDiskSize')]",
					"lun": 0,
					"createOption": "Empty",
					"managedDisk":{
						"storageAccountType": "[parameters('storageAccountTypeData')]"
					  }
				}]
			},
			"networkProfile": {
				"networkInterfaces": [{
					"id": "[resourceId('Microsoft.Network/networkInterfaces', concat(parameters('hostname'), '-nic'))]"
				}]
			}
		}
	}],
	"outputs": {}
}